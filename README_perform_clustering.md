# Perform_Clustering

Performs clustering on an ExpressionData file with various cluster and visualization options. 

## Usage

## Perform DBSCAN and create a DBSCAN_ClusterIDs.csv file

python perform_clustering.py -f path/to/ExpressionData.csv -d

## Perform k-means and creates an elbow_visualization.png file for clusters 2 to 5

python perform_clustering.py -f path/to/ExpressionData.csv -e

## Perform k-means silhouette and create a silhouette_visualization.png file for clusters 2 to 5
(Note: The default, without -u (upper bound) specified, is clusters 2 to 11)

python perform_clustering.py -f path/to/ExpressionData.csv -s -u 5

Note: any combination of -s, -e, and -d can be specified, for example:

python perform_clustering.py -f path/to/ExpressionData.csv -d -e -s


# INPUTS

-f: The ExpressionData file path
Required
The ExpressionData file is expected to be the same format as generated by BoolODE

-d: DBSCAN clustering is requested
Not required

-e: k-means elbow is requested
Not required

-s: k-means silhouette is requested
Not required

-u: upper bound for silhouette plots, which must be greater than 2
Not required


# OUTPUTS

-d: DBSCAN clustering is requested
The DBSCAN clustering outputs a DBSCAN_ClusterIDs.csv file, where each cell has its own cluster assigned by DBSCAN. Note: noise found by DBSCAN are put in a cluster for visualization purposes.

-e: k-means elbow is requested
The k-means elbow generates an elbow_visualization.png file with the elbow identified.

-s: k-means silhouette is requested
The k-means silhouette generates a silhouette_visualization.png file where the number of clusters is 2 until the number specified by -u. If no upper bound is specified by -u, the default upper bound is 11.

Note: All outputs are generated in the same directory as the provided ExpressionData.csv


# OUTPUT NOTES

## DBSCAN 

There is more work that needs to be done with DBSCAN, such as testing with lower simulation times and differing cell numbers. Additionally, DBSCAN is not suitable for datasets with varying density, and that is an analysis metric we want to include in the future (analyzing the density of the dataset and determining when DBSCAN is successful and what density works with particular models).

## ELBOW

The elbow method has one additional metric that can be implemented if the line defining the model type is changed from metric='calinski_harabasz' to metric='distortionâ€™ in k_means_elbow(). We have set it to calinski_harabasz because that has yielded closer results to the expected value on average for the particular models that we tested.

## SILHOUETTE

The silhouette_visualization.png file needs to be visually analyzed to determine the appropriate number of clusters. The correct estimated cluster number, according to Silhouette, corresponds to the plot where there that has the least number of negative coefficient values and has the most uniformity in the thickness of the clusters.


# OVERVIEW

The perform_clustering script is designed to analyze ExpressionData files generated by BoolODE to statistically analyze the data to try and cluster it and predict the number of steady states that exist in the boolean model. It currently supports k-means elbow, k-means silhouette, and DBSCAN.
